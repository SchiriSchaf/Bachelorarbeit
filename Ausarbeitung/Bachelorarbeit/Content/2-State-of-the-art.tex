%% ==============================
\chapter{\iflanguage{ngerman}{Stand der Wissenschenschaft und Technik}{State of the art}}
\label{sec:state_of_the_art}
%% ==============================



Die Arbeit von Tzeng \cite{tzeng2005intelligent} benutzt Machinelearning um interessante Strukturen darzustellen. Hierbei wird ein Neuronales Netz und eine Support Vecotr Machine benutzt.
\newline
Als Input für das Verfahren kann der Benutzer im Volumen mit zwei verschiedenen Farben Regionen anmalen und damit markieren. Mit der einen Farbe markiert der Nutzer die Stellen von Interesse, die er hervorgehoben haben möchte, mit der anderen Farbe Stellen, die ihn explizit nicht interessieren. Das Programm nimmt im Anschluss die Intensitätswerte, Länge der Gradienten und Intensitätswerte der Nachbarn aller markierter Voxel als Input um eine sinnvole Segmentierung zu finden. Das Ergebnis wird dem Anwender in Form einer farbigen Darstellung gezeigt, bei der er abhängig von der Farbe der Regionen sieht wie ähnlich sie den angemalten Voxeln sind. Gefällt dem Benutzer das Ergebnis noch nicht, so kann er durch weiteres einfärben von Regionen das Ergebnis verbessern bis das gewünschte Resultat erreicht wird.











Kindlmann und Durkin  \cite{kindlmann1998semi} - gradient


Bajaj Countour: \cite{bajaj1997contour} -1d


Correa und Ma Transferfunktion,basierend auf Größe \cite{correa2008size}, occlusion \cite{correa2009occlusion}, visibility \cite{correa2009visibility}(später histogram\cite{correa2011visibility})


Größe: 

\todo{region growing}



Imagebased:

 
Wu and Qu
proposed a system that uses editing operations and stochastic
search of the transfer function parameters to maximize the
similarity between volume-rendered images given by the user

Wu und Qu schlugen in ihrer Arbeit vor \cite{wu2007interactive}


Das Gebiet der Transferfunktionen ist weit erforscht und es existieren bereits viele verschiedene Methoden und Herangehensweisen. In diesem Abschnitt wird ein Überblick über die unterschiedlichen Vorgehensweisen von Transferfunktionen gegeben. Dabei werden diese im Folgenden in die Kategorien: eindimensionale Transferfunktionen, zweidimensionale Transferfunktionen, mehrdimensionale Transferfunktionen, ... unterteilt. Hierbei ist jedoch zu beachten, das manche der hier vorgestellten Verfahren mehrere Kategorien verbinden.


\subsection{Eindimensionale Transferfunktionen}

Die einfachste Form der Transferfunktionrm, sind die eindimensionalen Transferfunktionen. In diesen, wird nur der Intensitätswert der Voxel in Betracht gezogen. Abgesehe von den niedrigen Berechnungszeiten, sind diese jedoch aus mehreren Gründen suboptimal. Medizinischen Daten werden gemessen und haben deshalb meist ein Rauschen, was die genaue Darstellung erschwert. Weiterhin sind die Intensitätswerte verschiedener Bereiche nah beieinander oder gar gleich und damit sind eindimensionale Transferfunktionen unpraktisch um verschiedene Materialien kenntlich zu machen. Trotzdem sind eindimensionale Transferfunktionen weit verbreitet und werden oft benutzt. 
\newline




\subsection{Zweidimensionale Transferfunktionen}

Eine zweidimensionale Transferfunktion hat als Eingabeparameter zwei Werte. Oftmals werden hierbei der Gradient beziehungsweise desen Länge und der Intensitätswert eine Voxels genommen.


In der Arbeit von Wesarg und Kirschner \cite{wesarg2009structure, wesarg20102d} wird das "Stucture-Size-Enhanced Histogram" vorgestellt.
\newline
Dafür muss für jeden Voxel die "structure size estimators" berechnet werden. Dies geschieht, indem betrachtet wird, wie viele Schritte in die Richtung der 26 Nachbarn des Voxel gemacht werden kann. Ein Schritt kann gemacht werden, wenn der Intensitätswert des erreichten Voxels nicht mehr als ein gegebener Parameter abweicht. Die Schrittweiter startet mit einem Voxel und verdoppelt sich mit jedem gemachten Schritt bis hin zur Hälft der Größe des gegebenen Volumens. Für ein besseres Ergebnis wird nur der kleinere Wert von zwei entgegengesetzten Richtungen gespeichert. Die Akkumulation alle Werte ergibt die Größe der Struktur. Aus diesem und dem Intensitätswert wird ein zweidimensionales Histogram erstellt.





\subsection{Mehrdimensionale Transferfunktionen}




Sereda baut seine Arbeit \cite{sereda2006visualization} auf den von Serlie \cite{serlie2003computed} vorgestellten LH-Histogramen auf und zeigt wie man mit ihnen Objekte klassifizieren kann. Die Berechnung eines LH-Histograms ist eine Methode zur Erkennung von Kanten, unter der Verwendung von Low- und High-Werten. Dabei werden die Voxel in zwei verschiedenen Kategorien eingeteilt. Es gibt Voxel, die  innerhalb eines Materials liegen und welche, die  an der Grenze zweier Materialien liegen. Ist ein Voxel innerhalb, so sind seine LH-Werte gleich. Grenzvoxel hingegen haben unterschiedliche Low- und High-Werte, wobei disese die Intensitätswerte der beiden Materialien, zwischen denen die Grenze verläuft, beschreiben. 
\newline
Bei der Berechnung des Histograms wird als erstes getestet, ob der betrachtete Voxel an einer Grenze liegt. Ein Punkt liegt innerhalb eines Materials, wenn  die Länge des Gradienten kleiner als ein gewisses epsilon (bei MRT-Daten) oder gleich null(bei CT-Daten ist). In diesem Fall wären die Low- und High-Werte der Intensitätswert des Voxels. Ist dies jedoch nicht der Fall, wird in Richtung(für die High-Werte) und entgegengesetzter Richtung(für die Low-Werte) des Gradientens schrittweise integriert. Dies stoppt sobald ein Material gefunden wurde. Dies wird für jeden Punkt im Volumen berechnet und danach aus allen LH-Werten ein Histogram erstellt.
\newline 
Zur Visualisierung benutzt Sereda eine dreidimensionale Transferfunktion. Diese nimmt die beiden LH-Werte als auch die Gradientenlänge, aus dem Grund, dass vor allem Voxel nah an der Grenze interessant sind und diese dadurch hervorgehoben werden, als Parameter entgegen.
\newline
Weiterhin verwenden die Forscher Regiongrowing um Strukturen zu erkennen. Dabei basiert die Kostenfunktion auf dem LH-Histogram. Dies ist deutlich besser als Kostenfunktionen, die auf dem Intensitätswert und der Gradientenlänge basieren, da Kanten trotz Überlappungen besser erkannt werden können.
\todo{besser schreiben}
\newline
\newline
In einer späteren Arbeit \cite{sereda2006automating} stellt Sereda ein hierarschies Clusteringverfahren vor. Hierbei werden in einer Menge von Clustern immer die zwei gemerged, die sich bei dem ausgewählten Vergleichsverfahren am ähnlichsten sind. Es wird eine Kombination aus zwei solcher Vergleichsverfahren vorgestellt. Zum einen wird die räumliche Nähe in betracht gezogen, bei der gezählt wird, wie viele direkte Nachbarn zwei Cluster besitzen. Zum anderen wird die Nähe im LH-Raum untersucht. Als Startcluster dienen hierbei die Kästchen des LH-Histograms. Die einzelnen Cluster bekommen für die Visualisierung am Ende eine zufälligen Farbwert zugewiesen. 



Die Arbeit von Shouren Lan \cite{lan2017improving} befasst sich mit der Verbesserung von 2D Transferfunktionen die auf Skalarwerten und Gradienten(SG-TF) basieren. Genauer geht es darum das Problem vom Auftauchen von Überlappungen von Bereichen die nicht zusammen gehören zu vermeiden.
\newline
Dabei wird im Paper zwischen 3 verschiedenen Arten von Strukturen unterschieden:
\begin{itemize}
\item (i) Strukturen die keine andere Struktur berühren
\item (ii) Strukturen die keine andere Struktur berühren, jedoch nah an einer andern liegen
\item (iii) Strukturen die andere Strukturen berühren
\end{itemize} 
Wenn der Benutzer eine Region ausgewählt hat, werden zunächst alle Strukturen in dem Bereich klassifiziert und kleine Fragmente entfernt. Durch verschiedene Algorithmen werden Strukturen der Klassen (ii) durch Erosion, Dilatation, Aufteilen und neu zusammenfügen von einander getrennt. Strukturen der Klasse (iii) werden durch eine weitere niedrig dimensionale Transferfunktion getrennt. Anschließend werden durch das Aufteilen entstehende Löcher mit Hilfe von Dilatation gestopft. Als letztes wird durch eine Transferfunktion den Strukturen entsprechende Farben und Intensitäten zugewiesen.


\subsection{Räumliche Info}


Es gibt diverse Regiongrowingverfahren um Strukturen von interesse hervozuheben.
\newline
Beipsielsweise wird im Paper von Huang \cite{huang2003rgvis} ein solches Regiongrowingverfahren vorgestellt.
\newline
Der Benutzer kann einen Punkt von interesse im Volumen wählen, den sogenannten "seed". Es werden alle 26 Nachbarn des "seeds" besucht und anhand einer Kostenfunktion, die den entsprechenden Wert des besuchten Voxels und des Seedvoxels vergleicht, entschieden ob sie zu der Region dazugehören oder nicht. Sind sie Teil der Struktur werden auch ihre Nachbarn besucht und alle passenden Voxel zu der Region hinzugefügt. Diese Vorgang wiederholt sich so lange bis alle Voxel gefunden wurden, oder ein anderes internes Abbruchkriterium erfüllt wurde.  Es stehen dem Anwender 3 verschiedene Kostenfunktionen bereit. Die erste Funktion bezieht sich auf die Intensitätswerte der Voxel, die Zweite auf die Länge der jeweiligen Gradienten und bei der Dritten werden die Gewichte der Voxel verglichen, die vorher vom Benutzer definiert werden müssen. In einem Nachbearbeitungsschritt ist es anschließend noch möglich unpassende Elemente zu entfernen, wenn beispielsweise eine ganze weitere Struktur auch visualisiert wird, da sie über eine kleine Brücke von ein bis zwei Voxeln mit der eigentlich gesuchten Struktur verbunden ist.
\newline
Da das Regiongrowing sehr zeitaufwändig ist, kann der Anwender auswählen, dass er zunächst nur eine gewisse Teil der Region sich errechnen lässt.



Im Vergleich zu Huan \cite{huang2003rgvis} benutzt Chen  in seiner Arbeit \cite{chen2006sketch} nicht nur ein seedbasiertes Verfahren, sondern fügt noch ein sketchbasiertes Verfahren davor ein.
\newline
Anfangs wählt der Anwender eine Reihe an Intensitätswerten im Histogram, die für ihn interessant sind. Danach kann er direkt im Volumen eine Region von Interesse einzeichnen und markieren. Das Program schneidet im Anschluss, alle Teile des Volumens außerhalb der gewählten Region weg. Jetzt kann der Nutzer wie im vorrig vorgestllen Verfahren seinen "seed" setzen.
\newline
Dies erleichtert dem Benutzer die Anwendung, da er schneller zu seinem Punkt von Interesse gelangt ohne vorher durch diverese Querschnittsbilder iterieren zu müssen. Desweiteren ist es Zeitsparrend für den User, falls er sich nicht genau mit dem Datensatz und der zu Visualisierenden Region auskennt.


\subsection{Machine learning}
\subsection{Clustering basierte Transferfunktionen}

\todo{altes paper auch einbinden}
Das Paper von Binh P. Nguyen \cite{nguyen2012clustering} stellt ein clusteringbasiertes Verfahren um für den Benutzer interessante Gebiete hervozuheben.
Zunächst wird in einem Vorverarbeitungsschritt die Gradienten des Volumens berechnet. Hierzu wurde Hong's Methode \cite{hong2003method} verwendet. Im Anschluss daran wird anhand der Gradienten die LH-Werte mithilfe von Heuns Methode, ein modifizierte Euler Methode, ermittelt.Hierbei wird desweiteren eine Gewichtung abhängig von der zurückgelegten Strecke bei der Interpolation für den Low- bzw. High-Wert errechnet. Aus den LH-Werten und deren Gewichten wird anschließend ein LH-Histogram erzeugt.
\newline
Dem Benutzter steht dann ein zwei stufiges und ein drei stufiges Clusteringverfahren zur Auswahl, wobei die ersten beiden Clusteringschritte die Selben sind. 
Im ersten Clusteringschritt wird im LH-Raum mithilfe von "Meanshiftclustering" geclustert. Es wird für jeden LH-Wert alle Werte gefunden, die in einem Kreis mit einem Radius von 7\% - 9\%  des maximalen LH-Wertes um den ursprünglichen Punkt liegen. Anschließend wird der neue durchschnittliche Mittelpunkt von allen Punkten im Cluster ermittelt. Der Vorgang wiederholt sich der Mittelpunkt zwischen zwei Iterationen nur minimal ändert. Der komplette Vorgang wird für jeden Punkt im LH-Histogram wiederholt und in Folge werden Cluster, deren Mittelpunkt nah beieinander liegen zu einem Cluster gemerged.
\newline
Der zweite Clusteringschritt wird auf die Cluster des ersten Schittes angewendet. Hierbei wird auch "Meanschiftclustering" verwendet. Diesmal wird jedoch räumlich, also abhängig von der Position im Volumen, geclustert. Desweiteren werden die Parameter für den Suchradius und Distanz zweier Mittelpunkte damit sie gemerged werden angepasst.
\newline
Als Ergebnis der ersten zwei Schritte erhält man Cluster mit Voxeln die ähnliche LH-Werte haben, als auch räumlich nah beieinander liegen.
\newline
Im optionalen dritten und letzten Clusteringschritt wird hieraschisch geclustert. Hierbei wird für jeden Cluster die paarweise Nähe zu jedem anderen Cluster errechnet. Anschließend werden hieraschich immer die zwei Cluster, die sich am nähsten sind, zu einem gemerged, solange bis nur noch ein Cluster existiert.  Hierbei speichert das Programm jeweils welche Cluster wann miteinander gemerged wurden. Der Benutzer kann im Anschluss entscheiden wie viel Cluster er haben möchte. Abhängig davon, wird das hierarschiche Clustern umgekehrt und die Cluster werden wieder getrennt, bis die gewünschte Anzahl an Clustern erreicht ist.


\subsection{Imagebased}
Eine weitere Art Transferfunktionen anzuwenden, sind Verfahren, die auf ?einem Bild? basieren. Hier hat der Benutzer die Möglichkeit, mit dem Programm zu interagieren. Dies ist für einen unerfahrenen User intuitiver und er kann durch ausprobieren ein gewünschtes Ergebnis erzielen.

Fang stellt in seinem Paper \cite{fang1998image} ein Verfahren vor, bei dem die  Transferfunktioneine eine Abfolge von verschieden 3D Bildverabteitungsverfahren ist, deren Parameter vom Benutzer angepasst werden können.

Es gibt auch Methoden, bei denen ein Hilfswerkzeug zum Einsatz kommt. Zum Beispiel kann der Benutzer im Paper von Reitinger: \cite{reitinger2004user} sich gezielt Bereiche des Volumens hervorheben lassen, indem er sie mit einem Stift auswählt. Hierbei wird die Intensiät des ausgewählten Punktes als auch der räumliche Abstand zum Stift in Betracht gezogen.






























































